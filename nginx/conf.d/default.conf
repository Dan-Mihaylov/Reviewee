upstream reviewee_app {
    server web:8000;
}

server {
    listen 443 ssl;

    server_name 127.0.0.1; # the address

    ssl_certificate /etc/nginx/ssl/nginx.crt;
    ssl_certificate_key /etc/nginx/ssl/nginx.key;

    location /.well-known/acme-challenge/ {
        root /var/www/certbot;
    }

    location / {
        proxy_pass http://reviewee_app;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Host $host;
        proxy_redirect off;
    }

    location /static/ {
            alias /home/app/web/staticfiles/;
    }

    large_client_header_buffers 16 128k;
    client_max_body_size 5M;

}






#Conf that works bellow for developement
#upstream reviewee_app {
#    server web:8000;
#}
#
#server {
#    listen 80;
#
#    server_name 127.0.0.1; # the address
#
#    location /.well-known/acme-challenge/ {
#        root /var/www/certbot;
#    }

#    location / {
#        proxy_pass http://reviewee_app;
#        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#        proxy_set_header Host $host;
#        proxy_redirect off;
#    }

#    location /static/ {
#            alias /home/app/web/staticfiles/;
#    }

#    large_client_header_buffers 16 128k;
#    client_max_body_size 5M;

#}

